var UI={};+function(e){"use strict";function t(t,s){this.element=t,this._name=n,this._defaults=e.fn[n].defaults,this.options=e.extend(!0,{},this._defaults,s),this.elementType=this.element.type,this.$element=null,this.$parent=null,this.$helpBlock=null,this.$messagesList=null,this.everValue=null,this.init()}var n="validator";t.prototype.init=function(){this.buildDom(),this.buildCache(),this.bindEvents()},t.prototype.buildDom=function(){if("password"==this.elementType){var t=e('<ul class="list-unstyled"></ul>');for(var n in this.options.messages.password){var s='<li><span class="glyphicon glyphicon-ban-circle"></span> '+this.options.messages.password[n]+"</li>";t.append(s)}e(this.element).closest("div").append(t)}},t.prototype.buildCache=function(){this.$element=e(this.element),this.$parent=this.$element.closest(".form-group"),this.$helpBlock=this.$element.siblings(".help-block"),this.$messagesList=this.$parent.find("ul.list-unstyled")},t.prototype.bindEvents=function(){var e=this;e.$element.on("focus."+e._name,function(){e.everValue||(e.everValue=e.$element.val())}),e.$element.on("input."+e._name,function(){e.isValid()?e.cleanUp():e.everValue&&e.showError()}),e.$element.on("blur."+e._name,function(){(e.$element.val()||e.everValue)&&(e.isValid()?e.cleanUp():e.showError())}),e.$element.on("input."+e._name+", blur."+e._name,function(){"password"==e.elementType&&e.processPasswordMessages()})},t.prototype.isValid=function(){return"password"!=this.elementType?this.element.checkValidity():this.isValid_password().isValid},t.prototype.isValid_password=function(){var e=/^[\s\S]{8,}$/,t=/[A-Z]/,n=/[a-z]/,s=/[0-9]/,a=/[ !"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~]/,i=this.$element.val(),r={};r.conditions={},r.isValid=!0,r.conditions.minLength=e.test(i)?!0:!1,r.conditions.upper=t.test(i)?!0:!1,r.conditions.lower=n.test(i)?!0:!1,r.conditions.number=s.test(i)?!0:!1,r.conditions.special=a.test(i)?!0:!1;for(var o in r.conditions)r.conditions[o]===!1&&(r.isValid=!1);return r.isValid?this.element.setCustomValidity(""):this.element.setCustomValidity("invalid"),r},t.prototype.showError=function(){var e=this.getErrorMessage();this.$parent.addClass("has-error"),this.$helpBlock.removeClass("hidden").html(e)},t.prototype.cleanUp=function(){this.$helpBlock.addClass("hidden").html(),this.$parent.removeClass("has-error")},t.prototype.getErrorMessage=function(){var e=this.element.validity;for(var t in e)if(e[t])return this.formatMessage(t);return!1},t.prototype.formatMessage=function(e){var t=this.options.messages[e];return"tooShort"==e&&(t=t.replace("%N%",this.$element.attr("minlength"))),t},t.prototype.processPasswordMessages=function(){var e=this.isValid_password(),t=0;for(var n in e.conditions)t++,e.conditions[n]?this.$messagesList.find("li:nth-child("+t+")").addClass("text-success strong").find(".glyphicon").removeClass("glyphicon-ban-circle").addClass("glyphicon-ok-circle"):this.$messagesList.find("li:nth-child("+t+")").removeClass("text-success").find(".glyphicon").removeClass("glyphicon-ok-circle").addClass("glyphicon-ban-circle")},t.prototype.forceValidation=function(){return this.isValid()?this.cleanUp():this.showError(),"password"==this.elementType&&this.processPasswordMessages(),!1},e.fn[n]=function(s){return this.each(function(){var a=e(this),i=a.data("module_"+n),r=e.extend({},e.fn[n].defaults,a.data(),"object"==typeof s&&s);i||a.data("module_"+n,i=new t(this,r)),"string"==typeof s&&i[s]()})},e.fn[n].defaults={messages:{valueMissing:"The field is required",tooShort:"At least %N% characters",password:{minlength:"At least 8 characters long",upper:"Contains uppercase letters",lower:"Contains lowercase letters",number:"Contains numbers",special:"Contains punctuation"}}}}(jQuery),UI.core={},UI.core.model={applicationState:"registration"},UI.core.init=function(){UI.core.viewBuilder()},UI.core.viewBuilder=function(){function e(){d.addClass("modal-open"),r.removeClass("hidden"),o.removeClass("hidden")}function t(){d.removeClass("modal-open"),r.addClass("hidden"),o.addClass("hidden")}function n(){s.addClass("hidden"),a.addClass("hidden"),i.addClass("hidden")}var s=$(".registration"),a=$(".createEvent"),i=$(".eventsList"),r=$(".dim"),o=$(".spinner_global"),d=$("body");UI.events.process(),"registration"==UI.core.model.applicationState&&(n(),e(),setTimeout(function(){t(),s.removeClass("hidden")},1e3)),"createEvent"==UI.core.model.applicationState&&(n(),e(),setTimeout(function(){t(),a.removeClass("hidden")},1e3)),"list"==UI.core.model.applicationState&&(n(),e(),setTimeout(function(){t(),i.removeClass("hidden")},1e3))},UI.events={},UI.events.model={events:[]},UI.events.init=function(){var e=$(".eventsList .btn-success");e.each(function(){$(this).on("click",function(){UI.core.model.applicationState="createEvent",UI.core.viewBuilder()})})},UI.events.process=function(){var e=$(".eventsList > .page-header"),t=$(".eventsList > .events"),n=$(".eventsList > .emptyState");t.html(""),UI.events.model.events.length?(UI.events.model.events.forEach(function(e){var n=e.name?'<span class="event-name">'+e.name+"</span>":"",s=e.type?'<span class="label label-primary event-type">'+e.type+"</span>":"",a='<h2 class="event-title">'+n+s+"</h2>",i="",r="";e.startYear==(new Date).getFullYear()&&(e.startYear=""),e.endYear==(new Date).getFullYear()&&(e.endYear=""),e.startDate==e.endDate&&(i="event-when_sameDate"),e.endDate||(r="event-when_onlyStart");var o='<div class="event-fieldset-field event-when-startDate"><span class="event-fieldset-label">Date:</span><span class="event-fieldset-value"><span class="glyphicon glyphicon-calendar"></span>'+e.startDate+" "+e.startMonth+" "+e.startYear+"</span></div>",d='<div class="event-fieldset-field event-when-startTime"><span class="event-fieldset-label">Time:</span><span class="event-fieldset-value"><span class="glyphicon glyphicon-time"></span>'+e.startTime+"</span></div>",l=e.endDate?'<div class="event-fieldset-field event-when-endDate"><span class="event-fieldset-label">Date:</span><span class="event-fieldset-value"><span class="glyphicon glyphicon-calendar"></span>'+e.endDate+" "+e.endMonth+" "+e.endYear+"</span></div>":"",c=e.endTime?'<div class="event-fieldset-field event-when-endTime"><span class="event-fieldset-label">Time:</span><span class="event-fieldset-value"><span class="glyphicon glyphicon-time"></span>'+e.endTime+"</span></div>":"",v='<div class="event-fieldset event-when '+i+" "+r+'">'+o+d+l+c+"</div>",u=e.host?'<div class="event-fieldset-field event-where-host"><span class="event-fieldset-label">Host:</span><span class="event-fieldset-value">'+e.host+"</span></div>":"",h=e.location?'<div class="event-fieldset-field event-where-location"><span class="event-fieldset-label">Location:</span><span class="event-fieldset-value">'+e.location+"</span></div>":"",m=u||h?'<div class="event-fieldset event-where">'+u+h+"</div>":"",p="";e.guests.length&&(e.guests.forEach(function(e){p+='<div class="event-fieldset-field event-guests-guest"><span class="event-fieldset-label">Guests:</span><span class="event-fieldset-value"><span class="glyphicon glyphicon-user"></span>'+e+"</span></div>"}),p='<div class="event-fieldset event-guests">'+p+"</div>"),t.append('<div class="event">'+a+v+m+p+"</div>")}),e.removeClass("hidden"),t.removeClass("hidden"),n.addClass("hidden")):(e.addClass("hidden"),t.addClass("hidden"),n.removeClass("hidden"))},UI.registration=function(){var e=$("#registration"),t=$("#registration-name"),n=$("#registration-email"),s=$("#registration-pwd");t.validator({messages:{valueMissing:"We really need your name, mate",tooShort:"The name is too short, bro (at least %N% characters)"}}),n.validator({messages:{valueMissing:"What if it is an emergency?",typeMismatch:"It doesn't look like a valid email"}}),s.validator(),e.on("submit",function(a){return t.validator("forceValidation"),n.validator("forceValidation"),s.validator("forceValidation"),a.preventDefault(),e[0].checkValidity()===!1?!1:(UI.core.model.applicationState="list",void UI.core.viewBuilder())})},UI.createEvent={},UI.createEvent.init=function(){UI.createEvent.when.init(),UI.createEvent.guests.init(),UI.createEvent.where(),UI.createEvent.form.init()},UI.createEvent.when={},UI.createEvent.when.model={d_start:!0,d_end:!0,d_endVisible:!1,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],isUpdating:!1},UI.createEvent.when.init=function(){function e(){d.datepicker({autoclose:!0,startDate:UI.createEvent.when.model.d_start}),l.timepicker({template:!1,showInputs:!1,minuteStep:5,showMeridian:!1}),u.datepicker({autoclose:!0,startDate:UI.createEvent.when.model.d_end}),h.timepicker({template:!1,showInputs:!1,minuteStep:5,showMeridian:!1}),l.siblings(".input-group-addon").off("click"),h.siblings(".input-group-addon").off("click")}function t(){o.on("click",function(e){e.preventDefault(),c.removeClass("hidden"),o.addClass("hidden"),UI.createEvent.when.model.d_endVisible=!0}),v.on("click",function(e){e.preventDefault(),c.addClass("hidden"),o.removeClass("hidden"),UI.createEvent.when.model.d_endVisible=!1}),d.on("changeDate",function(){UI.createEvent.when.model.isUpdating||(UI.createEvent.when.model.isUpdating=!0,i(),UI.createEvent.when.model.isUpdating=!1)}),l.timepicker().on("changeTime.timepicker blur",function(){UI.createEvent.when.model.isUpdating||(UI.createEvent.when.model.isUpdating=!0,i(),UI.createEvent.when.model.isUpdating=!1)}),u.on("changeDate",function(){UI.createEvent.when.model.isUpdating||(UI.createEvent.when.model.isUpdating=!0,r(),UI.createEvent.when.model.isUpdating=!1)}),h.timepicker().on("changeTime.timepicker blur",function(){UI.createEvent.when.model.isUpdating||(UI.createEvent.when.model.isUpdating=!0,r(),UI.createEvent.when.model.isUpdating=!1)})}function n(e){var t,n;return"start"==e&&(t=d.datepicker("getDate"),n=s(l.val()),t.setHours(n.hours),t.setMinutes(n.minutes)),"end"==e&&(t=u.datepicker("getDate"),n=s(h.val()),t.setHours(n.hours),t.setMinutes(n.minutes)),t}function s(e){var t=e.split(":");return{hours:t[0]||0,minutes:t[1]||0}}function a(){return UI.createEvent.when.model.d_end-UI.createEvent.when.model.d_start<36e5?!0:!1}function i(){if(UI.createEvent.when.updateDates("start",n("start")),a()){var e=UI.createEvent.when.model.d_start;e.setHours(e.getHours()+1),UI.createEvent.when.updateDates("end",e)}}function r(){UI.createEvent.when.updateDates("end",n("end"))}var o=$("#createEvent-start-trigger"),d=$("#createEvent-start-date-group"),l=$("#createEvent-start-time"),c=$("#createEvent-end"),v=$("#createEvent-end-trigger"),u=$("#createEvent-end-date-group"),h=$("#createEvent-end-time");UI.createEvent.when.setDates(),e(),UI.createEvent.when.updateDates("start",UI.createEvent.when.model.d_start),UI.createEvent.when.updateDates("end",UI.createEvent.when.model.d_end),t()},UI.createEvent.when.setDates=function(){var e=new Date;UI.createEvent.when.model.d_start=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()+1),UI.createEvent.when.model.d_end=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()+2)},UI.createEvent.when.updateDates=function(e,t){var n=$("#createEvent-start-date-group"),s=$("#createEvent-start-time"),a=$("#createEvent-end-date-group"),i=$("#createEvent-end-time");"start"==e&&(UI.createEvent.when.model.d_start=new Date(t),UI.createEvent.when.model.isUpdating=!0,n.datepicker("setDate",UI.createEvent.when.model.d_start.getMonth()+1+"-"+UI.createEvent.when.model.d_start.getDate()+"-"+UI.createEvent.when.model.d_start.getFullYear()),s.timepicker("setTime",UI.createEvent.when.model.d_start.getHours()+":"+UI.createEvent.when.model.d_start.getMinutes()),UI.createEvent.when.model.isUpdating=!1),"end"==e&&(UI.createEvent.when.model.d_end=new Date(t),UI.createEvent.when.model.isUpdating=!0,a.datepicker("setDate",UI.createEvent.when.model.d_end.getMonth()+1+"-"+UI.createEvent.when.model.d_end.getDate()+"-"+UI.createEvent.when.model.d_end.getFullYear()),i.timepicker("setTime",UI.createEvent.when.model.d_end.getHours()+":"+UI.createEvent.when.model.d_end.getMinutes()),UI.createEvent.when.model.isUpdating=!1),a.datepicker("setStartDate",UI.createEvent.when.model.d_start)},UI.createEvent.when.clean=function(){UI.createEvent.when.setDates(),UI.createEvent.when.updateDates("start",UI.createEvent.when.model.d_start),UI.createEvent.when.updateDates("end",UI.createEvent.when.model.d_end),$("#createEvent-end").addClass("hidden"),$("#createEvent-start-trigger").removeClass("hidden")},UI.createEvent.guests={},UI.createEvent.guests.dom={$list:$(".guestsList"),$first:$(".guestsList .guestsList-guest:first-child")},UI.createEvent.guests.init=function(){function e(n){var s=n.find(".guestsList-trigger_remove"),a=n.find(".guestsList-trigger_add");s.on("click",function(e){e.preventDefault(),n.remove(),UI.createEvent.guests.manageLinksVisibility()}),a.on("click",function(n){n.preventDefault(),e(t()),UI.createEvent.guests.manageLinksVisibility()})}function t(){var e=$('<li class="guestsList-guest clearfix"></li>'),t='<div class="form-group guestsList-guest-name"><input type="text" class="form-control" placeholder="guest\'s name"></div><a href="#" class="guestsList-trigger guestsList-trigger_remove hidden">Remove</a><a href="#" class="guestsList-trigger guestsList-trigger_add hidden">+ Guest</a>';return n.append(e.append(t)),e}var n=UI.createEvent.guests.dom.$list,s=UI.createEvent.guests.dom.$first;e(s),UI.createEvent.guests.manageLinksVisibility()},UI.createEvent.guests.manageLinksVisibility=function(){var e=UI.createEvent.guests.dom.$list,t=e.children("li").length;e.children("li").each(function(e,n){var s=$(n).find(".guestsList-trigger_remove"),a=$(n).find(".guestsList-trigger_add");t-1>e?(a.addClass("hidden"),s.removeClass("hidden")):t>1?(a.removeClass("hidden"),s.removeClass("hidden")):(a.removeClass("hidden"),s.addClass("hidden"))})},UI.createEvent.guests.clean=function(){var e=UI.createEvent.guests.dom.$list;e.find("li").not(":first-child").remove(),UI.createEvent.guests.manageLinksVisibility()},UI.createEvent.where=function(){function e(e){$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json?latlng="+e.coords.latitude+","+e.coords.longitude+"&key=AIzaSyDjdMGfSpv44b2bVuKVW8AxBGmXTVHTRzA"}).done(function(e){i.val(e.results[0].formatted_address||"")}).always(function(){s()})}function t(e){s(),console.log(e)}function n(){r.removeClass("hidden"),a.addClass("hidden")}function s(){r.addClass("hidden"),a.removeClass("hidden")}var a=(new google.maps.places.Autocomplete(document.getElementById("createEvent-location"),{types:["geocode"]}),$(".geoLocation-icon")),i=$("#createEvent-location"),r=a.siblings(".spinner");navigator.geolocation&&(a.removeClass("hidden"),a.on("click",function(){n(),navigator.geolocation.getCurrentPosition(e,t)}))},UI.createEvent.form={},UI.createEvent.form.init=function(){function e(){a.removeClass("has-error"),o.addClass("hidden"),i[0].setCustomValidity(""),r[0].setCustomValidity("")}function t(){a.addClass("has-error"),o.removeClass("hidden"),i[0].setCustomValidity("invalid"),r[0].setCustomValidity("invalid")}var n=$("#createEvent"),s=$("#createEvent-name"),a=$("#createEvent-end"),i=$("#createEvent-end-date"),r=$("#createEvent-end-time"),o=a.find(".help-block"),d=$("#createEvent-cancel");s.validator(),n.on("keyup keypress",":input:not(textarea):not([type=submit]):not([type=button])",function(e){var t=e.keyCode;return 13===t?(e.preventDefault(),!1):void 0}),n.on("submit",function(a){return a.preventDefault(),s.validator("forceValidation"),UI.createEvent.when.model.d_end-UI.createEvent.when.model.d_start<=0?(t(),r.timepicker().on("changeTime.timepicker",function(){UI.createEvent.when.model.d_end-UI.createEvent.when.model.d_start>0&&e()}),r.timepicker().on("changeTime.timepicker",function(){UI.createEvent.when.model.d_end-UI.createEvent.when.model.d_start>0&&e()})):e(),n[0].checkValidity()===!1?!1:(UI.events.model.events.push(UI.createEvent.form.collectEvent()),UI.createEvent.form.clean(),UI.core.model.applicationState="list",UI.core.viewBuilder(),void 0)}),d.on("click",function(e){e.preventDefault(),UI.createEvent.form.clean(),UI.core.model.applicationState="list",UI.core.viewBuilder()})},UI.createEvent.form.collectEvent=function(){function e(){var e=[];return $("#createEvent .guestsList .guestsList-guest").each(function(){var t=$(this).find("input").val();t&&e.push(t)}),e}var t={};return t.guests=[],t.name=$("#createEvent-name").val(),t.type=$("#createEvent-type").val(),t.startDate=UI.createEvent.when.model.d_start.getDate(),t.startMonth=UI.createEvent.when.model.monthNames[UI.createEvent.when.model.d_start.getMonth()],t.startYear=UI.createEvent.when.model.d_start.getFullYear(),t.startTime=UI.createEvent.when.model.d_start.getHours()+":"+("0"+UI.createEvent.when.model.d_start.getMinutes()).slice(-2),UI.createEvent.when.model.d_endVisible&&(t.endDate=UI.createEvent.when.model.d_end.getDate(),t.endMonth=UI.createEvent.when.model.monthNames[UI.createEvent.when.model.d_end.getMonth()],t.endYear=UI.createEvent.when.model.d_end.getFullYear(),t.endTime=UI.createEvent.when.model.d_end.getHours()+":"+("0"+UI.createEvent.when.model.d_end.getMinutes()).slice(-2)),t.host=$("#createEvent-host").val(),t.location=$("#createEvent-location").val(),t.guests=e(),t.message=$("#createEvent-message").val(),t},UI.createEvent.form.clean=function(){$("#createEvent")[0].reset(),UI.createEvent.when.clean(),UI.createEvent.guests.clean()},$(document).ready(function(){UI.core.init(),UI.createEvent.init(),UI.registration(),UI.events.init()});
//# sourceMappingURL=maps/master.js.map
